CREATE VIEW `busquedas_2`  AS SELECT `b`.`name` AS `solicitante`, `a`.`ticket_id` AS `ticket_id`, `a`.`texto` AS `texto`, `a`.`campo` AS `campo`, `a`.`created_at` AS `created_at` FROM (((select `b`.`ticket_id` AS `ticket_id`,`a`.`valor` AS `texto`,`a`.`etiqueta` AS `campo`,`a`.`updated_at` AS `created_at` from (`actividad_ticket_campos` `a` join `actividad_tickets` `b`) where ((`a`.`tipo_control` in ('Texto','Lista')) and (`a`.`actividad_ticket_id` = `b`.`id`))) union select `tickets`.`id` AS `ticket_id`,`tickets`.`asunto` AS `texto`,'Asunto' AS `campo`,`tickets`.`created_at` AS `created_at` from `tickets` union select `actividad_tickets`.`id` AS `ticket_id`,`actividad_tickets`.`descripcion` AS `texto`,concat('Descripcion actividad ',(`actividad_tickets`.`secuencia` + 1)) AS `campo`,`actividad_tickets`.`created_at` AS `created_at` from `actividad_tickets` union select `actividad_tickets`.`id` AS `ticket_id`,`actividad_tickets`.`nombre` AS `texto`,concat('Titulo actividad ',(`actividad_tickets`.`secuencia` + 1)) AS `campo`,`actividad_tickets`.`created_at` AS `created_at` from `actividad_tickets` union select `ticket_avances`.`ticket_id` AS `ticket_id`,`ticket_avances`.`avance` AS `texto`,'Comentarios avance' AS `campo`,`ticket_avances`.`created_at` AS `created_at` from `ticket_avances` where (not((`ticket_avances`.`avance` like 'Cambió el estatus%'))) union select `b`.`ticket_id` AS `ticket_id`,`a`.`valor` AS `texto`,`a`.`etiqueta` AS `campo`,`a`.`created_at` AS `created_at` from (`ticket_avances_campos` `a` join `ticket_avances` `b`) where ((`a`.`ticket_avance_id` = `b`.`id`) and (`a`.`tipo` in ('Texto','Lista')))) `a` join (select `tickets`.`id` AS `id`,`users`.`name` AS `name` from (`tickets` join `users`) where (`tickets`.`creador_id` = `users`.`id`)) `b`) WHERE (`a`.`ticket_id` = `b`.`id`) ;



CREATE VIEW `busquedas`  AS SELECT `b`.`name` AS `solicitante`, `a`.`ticket_id` AS `ticket_id`, `a`.`texto` AS `texto`, `a`.`campo` AS `campo`, `a`.`created_at` AS `created_at` FROM (((select `b`.`ticket_id` AS `ticket_id`,`a`.`valor` AS `texto`,`a`.`etiqueta` AS `campo`,`a`.`updated_at` AS `created_at` from (`actividad_ticket_campos` `a` join `actividad_tickets` `b`) where ((`a`.`tipo_control` in ('Texto','Lista')) and (`a`.`actividad_ticket_id` = `b`.`id`))) union select `tickets`.`id` AS `ticket_id`,`tickets`.`asunto` AS `texto`,'Asunto' AS `campo`,`tickets`.`created_at` AS `created_at` from `tickets` union select `actividad_tickets`.`ticket_id` AS `ticket_id`,`actividad_tickets`.`descripcion` AS `texto`,concat('Descripcion actividad ',(`actividad_tickets`.`secuencia` + 1)) AS `campo`,`actividad_tickets`.`created_at` AS `created_at` from `actividad_tickets` union select `actividad_tickets`.`ticket_id` AS `ticket_id`,`actividad_tickets`.`nombre` AS `texto`,concat('Titulo actividad ',(`actividad_tickets`.`secuencia` + 1)) AS `campo`,`actividad_tickets`.`created_at` AS `created_at` from `actividad_tickets` union select `ticket_avances`.`ticket_id` AS `ticket_id`,`ticket_avances`.`avance` AS `texto`,'Comentarios avance' AS `campo`,`ticket_avances`.`created_at` AS `created_at` from `ticket_avances` where (not((`ticket_avances`.`avance` like 'Cambió el estatus%'))) union select `b`.`ticket_id` AS `ticket_id`,`a`.`valor` AS `texto`,`a`.`etiqueta` AS `campo`,`a`.`created_at` AS `created_at` from (`ticket_avances_campos` `a` join `ticket_avances` `b`) where ((`a`.`ticket_avance_id` = `b`.`id`) and (`a`.`tipo` in ('Texto','Lista')))) `a` join (select `tickets`.`id` AS `id`,`users`.`name` AS `name` from (`tickets` join `users`) where (`tickets`.`creador_id` = `users`.`id`)) `b`) WHERE (`a`.`ticket_id` = `b`.`id`) ;




